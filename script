-- CONFIG INIZIALE (già ottimizzati, non cambiare se non sai)
local BEST_FOV_SIZE = 340 -- Miglior valore per FOV
local BEST_SMOOTHNESS = 0.62 -- Miglior valore per smoothing

-- Variabili globali
local AimEnabled = true
local SilentAimEnabled = false
local ESPEnabled = true
local FOVCircleEnabled = true

local FOVSize = BEST_FOV_SIZE
local AimSmoothness = BEST_SMOOTHNESS

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera

-- GUI semplice (puoi personalizzare)
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
local FOVCircle = Instance.new("Circle", ScreenGui)
FOVCircle.Radius = FOVSize
FOVCircle.Color = Color3.new(1, 0, 0)
FOVCircle.Thickness = 2
FOVCircle.Transparency = 0.5
FOVCircle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
FOVCircle.Visible = FOVCircleEnabled

-- Bypass base (esempio: nasconde il tuo movimento di mouse)
local function BypassAntiCheat()
    -- Qui puoi mettere funzioni per bypass semplici o anti rilevamento
    -- Per esempio, filtrare movimenti troppo bruschi, randomizzare leggermente
    -- oppure bloccare eventi sospetti (dipende dal gioco)
end

-- Funzione per ottenere il target migliore (closest in FOV e non team)
local function GetClosestTarget()
    local closestTarget = nil
    local shortestDistance = FOVSize
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") then
            local headPos, onScreen = Camera:WorldToViewportPoint(player.Character.Head.Position)
            if onScreen then
                local dist = (Vector2.new(headPos.X, headPos.Y) - Vector2.new(Mouse.X, Mouse.Y)).magnitude
                local isEnemy = true -- Qui metti check squadra, se vuoi
                if dist < shortestDistance and isEnemy then
                    shortestDistance = dist
                    closestTarget = player
                end
            end
        end
    end
    return closestTarget
end

-- Aimbot semplice con smooth
local function AimAtTarget(target)
    if not target or not target.Character then return end
    local head = target.Character:FindFirstChild("Head")
    if not head then return end
    local headPos = Camera:WorldToViewportPoint(head.Position)
    local mousePos = Vector2.new(Mouse.X, Mouse.Y)

    local targetPos = Vector2.new(headPos.X, headPos.Y)
    local newPos = mousePos:Lerp(targetPos, AimSmoothness)

    -- Muove il mouse verso il nuovo punto (qui devi usare il metodo giusto a seconda del gioco)
    mousemoverel(newPos.X - mousePos.X, newPos.Y - mousePos.Y)
end

-- ESP basico con colori
local ESPFolder = Instance.new("Folder", ScreenGui)
ESPFolder.Name = "ESPFolder"

local function CreateESPForPlayer(player)
    local espBox = Drawing.new("Square")
    espBox.Color = Color3.fromRGB(0, 255, 0) -- Verde per esempio (puoi variare)
    espBox.Thickness = 2
    espBox.Transparency = 1
    espBox.Filled = false
    espBox.Visible = false

    local espName = Drawing.new("Text")
    espName.Text = player.Name
    espName.Color = Color3.fromRGB(255, 255, 255)
    espName.Size = 14
    espName.Center = true
    espName.Visible = false

    return {Box = espBox, Name = espName}
end

local ESPData = {}

-- Aggiorna ESP ogni frame
local function UpdateESP()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") then
            if not ESPData[player] then
                ESPData[player] = CreateESPForPlayer(player)
            end

            local headPos, onScreen = Camera:WorldToViewportPoint(player.Character.Head.Position)
            local esp = ESPData[player]

            if onScreen then
                local size = 50 -- dimensione box fissa o calcolata
                esp.Box.Position = Vector2.new(headPos.X - size/2, headPos.Y - size/2)
                esp.Box.Size = Vector2.new(size, size)
                esp.Box.Visible = ESPEnabled

                esp.Name.Position = Vector2.new(headPos.X, headPos.Y - size/2 - 15)
                esp.Name.Visible = ESPEnabled
            else
                esp.Box.Visible = false
                esp.Name.Visible = false
            end
        end
    end
end

-- Aggiorna posizione e dimensione FOV circle
local function UpdateFOVCircle()
    FOVCircle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
    FOVCircle.Radius = FOVSize
    FOVCircle.Visible = FOVCircleEnabled
end

-- Main loop (RunService)
RunService.RenderStepped:Connect(function()
    BypassAntiCheat()

    if AimEnabled then
        local target = GetClosestTarget()
        if target then
            AimAtTarget(target)
        end
    end

    if ESPEnabled then
        UpdateESP()
    end
end)

-- Aggiorna FOV circle ogni frame (fuori dal main loop)
RunService.RenderStepped:Connect(UpdateFOVCircle)

-- GUI o comandi per cambiare parametri (da implementare)

print("Script iniziato con FOV size: " .. BEST_FOV_SIZE .. " e Aim Smoothness: " .. BEST_SMOOTHNESS .. " (valori migliori già settati)")

